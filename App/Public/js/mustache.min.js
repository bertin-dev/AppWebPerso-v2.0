!function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return h(e)?"array":typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}function a(e,t){return g.call(e,t)}function o(e){return!a(v,e)}function s(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return $[e]})}function c(t,n){function r(){if(v&&!$)for(;g.length;)delete m[g.pop()];else g=[];v=!1,$=!1}function a(e){if("string"==typeof e&&(e=e.split(w,2)),!h(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(i(e[0])+"\\s*"),c=new RegExp("\\s*"+i(e[1])),d=new RegExp("\\s*"+i("}"+e[1]))}if(!t)return[];var s,c,d,f=[],m=[],g=[],v=!1,$=!1;a(n||e.tags);for(var C,x,S,U,E,j,P=new p(t);!P.eos();){if(C=P.pos,S=P.scanUntil(s))for(var T=0,I=S.length;T<I;++T)U=S.charAt(T),o(U)?g.push(m.length):$=!0,m.push(["text",U,C,C+1]),C+=1,"\n"===U&&r();if(!P.scan(s))break;if(v=!0,x=P.scan(b)||"name",P.scan(y),"="===x?(S=P.scanUntil(_),P.scan(_),P.scanUntil(c)):"{"===x?(S=P.scanUntil(d),P.scan(k),P.scanUntil(c),x="&"):S=P.scanUntil(c),!P.scan(c))throw new Error("Unclosed tag at "+P.pos);if(E=[x,S,C,P.pos],m.push(E),"#"===x||"^"===x)f.push(E);else if("/"===x){if(j=f.pop(),!j)throw new Error('Unopened section "'+S+'" at '+C);if(j[1]!==S)throw new Error('Unclosed section "'+j[1]+'" at '+C)}else"name"===x||"{"===x||"&"===x?$=!0:"="===x&&a(S)}if(j=f.pop())throw new Error('Unclosed section "'+j[1]+'" at '+P.pos);return u(l(m))}function l(e){for(var t,n,i=[],r=0,a=e.length;r<a;++r)t=e[r],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(i.push(t),n=t));return i}function u(e){for(var t,n,i=[],r=i,a=[],o=0,s=e.length;o<s;++o)switch(t=e[o],t[0]){case"#":case"^":r.push(t),a.push(t),r=t[4]=[];break;case"/":n=a.pop(),n[5]=t[2],r=a.length>0?a[a.length-1][4]:i;break;default:r.push(t)}return i}function p(e){this.string=e,this.tail=e,this.pos=0}function d(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}var m=Object.prototype.toString,h=Array.isArray||function(e){return"[object Array]"===m.call(e)},g=RegExp.prototype.test,v=/\S/,$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},y=/\s*/,w=/\s+/,_=/\s*=/,k=/\s*\}/,b=/#|\^|\/|>|\{|&|=|!/;p.prototype.eos=function(){return""===this.tail},p.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},p.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},d.prototype.push=function(e){return new d(e,this)},d.prototype.lookup=function(e){var n,i=this.cache;if(i.hasOwnProperty(e))n=i[e];else{for(var a,o,s=this,c=!1;s;){if(e.indexOf(".")>0)for(n=s.view,a=e.split("."),o=0;null!=n&&o<a.length;)o===a.length-1&&(c=r(n,a[o])),n=n[a[o++]];else n=s.view[e],c=r(s.view,e);if(c)break;s=s.parent}i[e]=n}return t(n)&&(n=n.call(this.view)),n},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(t,n){var i=this.cache,r=i[t];return null==r&&(r=i[t+":"+(n||e.tags).join(":")]=c(t,n)),r},f.prototype.render=function(e,t,n){var i=this.parse(e),r=t instanceof d?t:new d(t);return this.renderTokens(i,r,n,e)},f.prototype.renderTokens=function(e,t,n,i){for(var r,a,o,s="",c=0,l=e.length;c<l;++c)o=void 0,r=e[c],a=r[0],"#"===a?o=this.renderSection(r,t,n,i):"^"===a?o=this.renderInverted(r,t,n,i):">"===a?o=this.renderPartial(r,t,n,i):"&"===a?o=this.unescapedValue(r,t):"name"===a?o=this.escapedValue(r,t):"text"===a&&(o=this.rawValue(r)),void 0!==o&&(s+=o);return s},f.prototype.renderSection=function(e,n,i,r){function a(e){return o.render(e,n,i)}var o=this,s="",c=n.lookup(e[1]);if(c){if(h(c))for(var l=0,u=c.length;l<u;++l)s+=this.renderTokens(e[4],n.push(c[l]),i,r);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(e[4],n.push(c),i,r);else if(t(c)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");c=c.call(n.view,r.slice(e[3],e[5]),a),null!=c&&(s+=c)}else s+=this.renderTokens(e[4],n,i,r);return s}},f.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||h(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},f.prototype.renderPartial=function(e,n,i){if(i){var r=t(i)?i(e[1]):i[e[1]];return null!=r?this.renderTokens(this.parse(r),n,i,r):void 0}},f.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},f.prototype.escapedValue=function(t,n){var i=n.lookup(t[1]);if(null!=i)return e.escape(i)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.0",e.tags=["{{","}}"];var C=new f;return e.clearCache=function(){return C.clearCache()},e.parse=function(e,t){return C.parse(e,t)},e.render=function(e,t,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return C.render(e,t,i)},e.to_html=function(n,i,r,a){var o=e.render(n,i,r);return t(a)?void a(o):o},e.escape=s,e.Scanner=p,e.Context=d,e.Writer=f,e});